<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Riesgos de Gobierno Corporativo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/gaugeJS/dist/gauge.min.js"></script>
    <link href="../estilos/estiloConclusiones.css" rel="stylesheet">
    <!-- <link href="css/st-gobCorpo.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Abel&family=Barlow+Condensed:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Courgette&family=Gupter:wght@400;500;700&family=PT+Sans+Narrow:wght@400;700&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&family=Roboto+Serif:ital,opsz,wght@0,8..144,100..900;1,8..144,100..900&display=swap"
        rel="stylesheet">
    <style>
        .centered {
            text-align: center;
        }
    </style>
</head>

<body id="conclusiones">
    <div class="survey-container-conclusiones">
        <div id="contenido">
            <section class="main">
                <section class="gobCorpo">
                    <div class="header-container">
                        <div>
                            <div id="nombreEmpresa" class="company-name"></div>
                            <div id="nombreUsuario" class="user-name"></div>
                        </div>
                        <h4> A - Manejo de los Riesgos de Gobierno Corporativo</h4>
                        <h5> Autoevaluación</h5>
                    </div>
                    <hr>

                    <!-- <form id="formulario"> -->
                    <div class="contenedorTitulo">
                        <div class="logo-container">
                            <a href="Menu-General.html">
                                <img src="../img/contenido (1).png" alt="Logo Izquierda" class="logo" style="width: 30px; 
                        height: auto">;
                            </a>
                        </div>
                        <div class="center-container-titulo">
                            <h4 class="tituloSeccionContainer"><a href="Menu-General.html">Conclusión</a></h4>
                        </div>
                    </div>

                    <table class="table-conclusiones">
                        <p class="pconclusiones">La presente autoevaluación tiene como objetivo medir la efectividad del
                            Manejo de los Riesgos de Gobierno Corporativo. A través de este ejercicio, se analiza cómo la organización es
                            estructurada, estrategizada, administrada, controlada y transparentada, asignando
                            una puntuación a cada elemento evaluado. Los resultados se presentan a continuación.</p>

                        <table style="width: 300px">
                            <tr>
                                <th class="pregunta-col">Puntaje</th>
                            </tr>
                        </table>

                        <p class="pconclusiones">La autoevaluación asigna un valor numérico a cada una de las
                            declaraciones, reflejando su contribución al Gobierno Corporativo. Cada elemento evaluado
                            posee un valor máximo, el cual representa el óptimo. En el contexto de esta evaluación, el
                            puntaje máximo obtenido ha sido:</p>

                        <div class="container-resultados">
                            Puntaje óptimo del factor:
                            <p id="puntajeTotal" style="display: inline; font-weight: bold; margin: 0;"></p>
                            <span>puntos |</span>
                            <span>Puntaje obtenido: <span id="puntajeObtenido"
                                    style="display: inline; font-weight: bold; margin: 0;"></span></span>
                            <span>| Porcentaje: <span id="porcentajeObtenido"
                                    style="display: inline; font-weight: bold; margin: 0;"></span>%</span>
                        </div>


                        <p class="pconclusiones">Este porcentaje ofrece una visión consolidada del desempeño global de
                            la empresa, englobando la calificación de los elementos distribuidos en los cuatro
                            grupos
                            que se detallan a continuación.</p>
                    </table>

                    <br>

                    <h1>Situaciones NO EFECTIVAS</h1>
                    <p class="pconclusiones">Los elementos que se encuentran en esta categoría han obtenido una
                        puntuación que no ha logrado superar el 50% de la puntuación óptima.</p>

                    <table class="table-cuadro-conclusiones">
                        <thead>
                            <tr>
                                <th id="namePlayer" rowspan="2" style="position:sticky; left:0;">Sección</th>
                                <th colspan="4">Calificación: 0 - 50%</th>
                            </tr>
                            <tr>
                                <th>Óptimo</th>
                                <th>Obtenido</th>
                                <th>%</th>
                                <th>Ver</th>
                            </tr>
                        </thead>
                        <tbody id="questionsTableBody" style="font-size: 12px; font-family: Abel">
                        </tbody>
                    </table>
                    <br>

                    <h1>Situaciones POCO EFECTIVAS </h1>
                    <p class="pconclusiones">Este grupo incluye aquellos elementos que han logrado una puntuación entre
                        el 50% y el 70%. </p>
                    <table class="table-cuadro-conclusiones">
                        <thead>
                            <tr>
                                <th id="namePlayer1" rowspan="2" style="position:sticky; left:0;">Sección</th>
                                <th colspan="4">Calificación: 50.01 - 70%</th>
                            </tr>
                            <tr>
                                <th>Óptimo</th>
                                <th>Obtenido</th>
                                <th>%</th>
                                <th>Ver</th>
                            </tr>
                        </thead>
                        <tbody id="questions5170">
                        </tbody>
                    </table>
                    <br>

                    <h1>Situaciones EFECTIVAS </h1>
                    <p class="pconclusiones">Los elementos clasificados como efectivos han obtenido una puntuación entre
                        el 70% y el 90% del valor ideal.</p>
                    <table class="table-cuadro-conclusiones">
                        <thead>
                            <tr>
                                <th id="namePlayer2" rowspan="2" style="position:sticky; left:0;">Sección</th>
                                <th colspan="4">Calificación: 70.01 - 90%</th>
                            </tr>
                            <tr>
                                <th>Óptimo</th>
                                <th>Obtenido</th>
                                <th>%</th>
                                <th>Ver</th>
                            </tr>
                        </thead>
                        <tbody id="questions7190">
                        </tbody>
                    </table>
                    <br>

                    <h1>Situaciones MUY EFECTIVAS </h1>
                    <p class="pconclusiones">Los elementos en esta categoría han logrado una puntuación superior al 90%.
                    </p>
                    <table class="table-cuadro-conclusiones">
                        <thead>
                            <tr>
                                <th id="namePlayer3" rowspan="2" style="position:sticky; left:0;">Sección</th>
                                <th colspan="4">Calificación: 90.01 - 100%</th>
                            </tr>
                            <tr>
                                <th>Óptimo</th>
                                <th>Obtenido</th>
                                <th>%</th>
                                <th>Ver</th>
                            </tr>
                        </thead>
                        <tbody id="questions90100">
                        </tbody>
                    </table>
                    <br>
                    <br>
                </section>
            </section>
        </div>
        <div class="centrado-flex">
            <button onclick="printPage()" id="boton-enviar">Generar Informe</button>
        </div>
    </div>

    <div id="modalGeneral" class="dialog-overlay" style="display:none;">
        <div class="dialog-container">
            <div class="dialog-box">
                <div class="dialog-header">
                    <span class="dialog-title">Matriz de Datos |</span>
                    <button id="closeDialog" class="dialog-close">&times;</button>
                </div>
                <div style="text-align: center;">
                    Sección:
                    <p id="nombreSeccion" style="display: inline; font-weight: bold; margin: 0;"></p>
                    <span> |</span>
                    <span>Puntaje obtenido: <span id="nombrePuntaje"
                            style="display: inline; font-weight: bold; margin: 0;"></span></span>
                    <span>| Porcentaje: <span id="nombrePorciento"
                            style="display: inline; font-weight: bold; margin: 0;"></span>%</span>
                </div>
                <div class="dialog-content">
                    <p id="tituloModalGeneral"></p>
                    <!-- <table id="tablaModalGeneral"> -->
                    <table id="dataTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Sec</th>
                                <th>Nro</th>
                                <th>Declaración</th>
                                <th>Respuesta</th>
                                <!-- <th>Obs.</th> -->
                            </tr>
                        </thead>
                        <tbody id="lineaModalGeneral">
                            <!-- Las filas dinámicas se insertarán aquí -->
                        </tbody>
                    </table>
                </div>
                <!-- </div> -->
                <div class="dialog-footer">
                    <button onclick="cerrarModal('modalGeneral')" class="dialog-button">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function printPage() {
            window.print();
        }

        function generarPDF() {
            const { jsPDF } = window.jspdf;
            const element = document.getElementById('contenido'); // Selecciona el elemento que deseas convertir en PDF

            // Configurar opciones para html2canvas
            const opciones = {
                scale: 2,  // Aumenta la calidad de la captura de pantalla
                useCORS: true, // Permitir recursos externos si es necesario
                willReadFrequently: true // Optimiza operaciones de lectura en el canvas
            };

            html2canvas(element, opciones).then(canvas => {
                const imgData = canvas.toDataURL('image/png');

                const pdf = new jsPDF('p', 'mm', 'a4'); // Formato A4 (210mm x 297mm)
                const pageWidth = 200; // Ancho de la página en mm (A4)  210
                const pageHeight = 290; // Altura de la página en mm (A4)  297
                // const imgWidth = pageWidth; // Ajustar la imagen al ancho de la página
                // const imgHeight = (canvas.height * imgWidth) / canvas.width; // Mantener proporciones de la imagen


                const margin = 10; // Margen superior e inferior de 10 mm
                const imgWidth = pageWidth - margin * 2; // Ajustar la imagen para que respete los márgenes
                const imgHeight = (canvas.height * imgWidth) / canvas.width; // Mantener proporciones de la imagen

                let posicionY = 0;
                let paginaActual = 1;
                let alturaRestante = imgHeight;

                while (alturaRestante > 0) {
                    pdf.addImage(imgData, 'PNG', 0, posicionY, imgWidth, imgHeight);

                    alturaRestante -= pageHeight;
                    posicionY -= pageHeight;

                    if (alturaRestante > 0) {
                        pdf.addPage(); // Agregar nueva página si aún queda contenido por añadir
                    }
                }

                pdf.save('documento_largo.pdf'); // Guarda el PDF
            });
        }

    </script>

    <script>
        document.getElementById("closeDialog").addEventListener("click", function () {
            document.getElementById("modalGeneral").style.display = "none";
        });
    </script>

</body>

<script src="../../js/ma-conclusiones.js"></script>

</html>